#include "functions.h"

#define NEW_STREAM L":R0m4"

extern  PPEB GetPEB(void);
extern  DWORD CheckDebugger(void);


BOOL CheckDebuggerPresence(void) {

	PPEB gPEB = GetPEB();

	if (CheckDebugger() != 0) {
		Warning("Debugger has been detected !!!Next time !");

		return TRUE;
	}

	info("No debugger Detected let's start!!!");
	return FALSE;

}

int main(void) {

	if (!CheckDebuggerPresence()) {
		info("Executing payload");
		MessageBoxW(NULL, L"Malware executes", L"Be Ready", MB_ICONEXCLAMATION | MB_HELP);
		return EXIT_SUCCESS;
	}

}