
---

# RC4 Encryption

This folder contains an implementation of RC4 encryption using WinAPI functions. The project demonstrates how RC4 encryption can be applied to protect sensitive data in Windows environments.

## Overview

RC4 is a widely used stream cipher that encrypts data by combining it with a pseudo-random keystream. This implementation showcases how to use RC4 encryption with WinAPI functions, such as `VirtualAllocEx`, `WriteProcessMemory`, and `CreateRemoteThread`, to manipulate and protect data in memory.

### Key Features

- **WinAPI Integration**: The project leverages various WinAPI functions to allocate memory, write encrypted data, and create remote threads for execution.
- **Dynamic Encryption**: RC4 encryption is applied dynamically to demonstrate protection of data in runtime scenarios.

## Before and After Encryption

To illustrate the effectiveness of RC4 encryption, we conducted an analysis using VirusTotal. Below are the results before and after applying RC4 encryption.

### Before Encryption

This is how the file appears before encryption, where the data is in plaintext and can be easily detected by security tools.

![Screenshot 2024-08-31 141758](https://github.com/user-attachments/assets/9ec8cc5a-1440-4603-9db0-950fbfa2609a)

*The analysis shows that the plaintext file is flagged by several antivirus engines.*

### After RC4 Encryption

Once RC4 encryption is applied, the file is transformed into a ciphered form, significantly reducing its detectability by security tools.

![Screenshot 2024-08-31 224445](https://github.com/user-attachments/assets/674f0197-9773-4dc3-9f2b-0656e2a7ad03)

*The analysis shows a noticeable decrease in detection by antivirus engines after encryption.*

## How It Works

1. **Key Scheduling Algorithm (KSA)**: The RC4 algorithm starts by initializing the key and setting up the state array.
2. **Pseudo-Random Generation Algorithm (PRGA)**: The keystream is generated and XORed with the plaintext to produce the ciphertext.
3. **WinAPI Functions**: The following WinAPI functions are used in the implementation:
   - `VirtualAllocEx`: Allocates memory in the target process.
   - `WriteProcessMemory`: Writes the encrypted data to the allocated memory.
   - `CreateRemoteThread`: Executes the encrypted payload within the target process.

## Usage

To use the RC4 encryption implementation, compile the provided source code using Visual Studio or another compatible compiler. The encrypted payload can then be injected into a target process using the provided WinAPI functions.
